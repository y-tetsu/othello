# 遺伝的アルゴリズムを使ったSwitchのパラメータ検討

## 既存パラメータ(Edge)
Tableパラメータ(corner, c, a1, a2, b1, b2, b3, x, o1, o2)+着手可能数パラメータ(wp)+勝敗パラメータ(ww)+エッジパラメータ(we)にて盤面を評価する。
反復深化により0.5秒の制限時間まで段階的に深く手を読む。
序盤は定石打ち、終盤残り9手からは石差を読み手を選ぶ。
```
corner : [   50]
c      : [  -20]
a1     : [    0]
a2     : [   -1]
b1     : [   -1]
b2     : [   -1]
b3     : [   -1]
x      : [  -25]
o1     : [   -5]
o2     : [   -5]
wp     : [    5]
ww     : [10000]
we     : [  100]
```

## switch_t
### 目的
Tableパラメータ(corner, c, a1, a2, b, o, x)をより強くするパラメータ値を求める。
かつ、ゲームの進行に合わせた5段階分(1～13手, 14～25手, 26～37手, 38～49手, 50～60手)のパラメータ値を求める。

### 条件
ランダムなパラメータ値(±250の範囲)の個体から開始し、既存パラメータの個体と1手読み同士で対戦させ勝率の高いものを次の世代に入れ替える。

```JSON
{
    "max_generations": 1000,
    "population_num": 24,
    "offspring_num": 12,
    "mutation_chance": 0.1,
    "mutation_value": 6,
    "large_mutation": 100,
    "large_mutation_value": 25,
    "turns": [12, 24, 36, 48, 60],
    "board_size": 8,
    "matches": 250,
    "threshold": 85,
    "random_opening": 6,
    "processes": 2
}
```

### 結果
3回目の試行の1500世代あたりで79%程度の勝率となる個体が現れたが
複数手を読む戦略にパラメータを適用したところ弱くなったため中断。<br>

![switch_t](https://raw.githubusercontent.com/y-tetsu/reversi/images/switch_t.png)

```
世代数 : 1531
適応度 : 79.4%(vs既存パラメータの勝率)
corner : [-151,   63, -104, -188,  -56]
c      : [  64,  -20,  -47, -177,  189]
a1     : [ 130,  163,   76,  -31, -121]
a2     : [ 157,   17,  145,  190,  125]
b      : [   4,   55,   39,  129,  217]
o      : [ 101,  146,   25,   -1,  -34]
x      : [-182, -186, -238,  -97,  112]
```

## switch2_tw
### 目的
Tableパラメータ(corner, c, a1, a2, b, o, x)+勝敗パラメータ(ww)をより強くするパラメータ値を求める。
かつ、ゲームの進行に合わせた5段階分のパラメータ値を求める。

### 条件
ランダムなパラメータ値の個体(wwは100000固定、それ以外は±250の範囲))から開始し、既存パラメータの個体と2手読み同士で対戦させ勝率の高いものを次の世代に入れ替える。

```JSON
{
    "max_generations": 200,
    "population_num": 24,
    "offspring_num": 12,
    "mutation_chance": 0.1,
    "mutation_value": 6,
    "large_mutation": 100,
    "large_mutation_value": 25,
    "turns": [12, 24, 36, 48, 60],
    "board_size": 8,
    "matches": 100,
    "threshold": 85,
    "random_opening": 8,
    "processes": 2
}
```

### 結果
200世代ほど繰り返すも勝率が20%からあがる気配がなく中断。<br>

![switch2_tw](https://raw.githubusercontent.com/y-tetsu/reversi/images/switch2_tw.png)

```
世代数 : 186
適応度 : 26.0%(vs既存パラメータの勝率)
corner : [   -42,     -9,    111,   -17,   218]
c      : [    -2,    -51,     57,    25,   139]
a1     : [  -141,     -3,   -134,  -144,  -166]
a2     : [   188,     46,   -123,   236,  -192]
b      : [   197,    -14,    -60,  -176,   -29]
o      : [  -202,   -136,   -207,   -23,    18]
x      : [    68,    -69,    -35,   190,  -175]
ww     : [100000, 100000, 100002, 99999, 99997]
```

## switch2f9j_tpwe(1)
### 目的
Tableパラメータ(corner, c, a1, a2, b1, b2, b3, x, o1, o2)+着手可能数パラメータ(wp)+勝敗パラメータ(ww)+エッジパラメータ(we)をより強くするパラメータ値を求める。
かつ、ゲームの進行に合わせた5段階分のパラメータ値を求める。
定石打ちと終盤石差読み(残り9手)も適用する。

### 条件
1. ランダムなパラメータ値(±300の範囲)の個体から開始し、既存パラメータの個体と2手読み同士で対戦させ勝率の高いものを次の世代に入れ替える。
2. 1.を200世代進める。
3. 2.を6回分用意する。
4. 6回分の結果から適応度の大きさに応じた確率で12個体選び、これを6回分用意する。
5. 4.を200世代進める。
6. 4～5を繰り返す。

```JSON
{
    "max_generations": 200,
    "population_num": 12,
    "offspring_num": 6,
    "mutation_chance": 0.1,
    "mutation_value": 6,
    "large_mutation": 100,
    "large_mutation_value": 25,
    "turns": [12, 24, 36, 48, 60],
    "board_size": 8,
    "matches": 50,
    "threshold": 80,
    "random_opening": 8,
    "processes": 2
}
```

### 結果
1200世代分ほど繰り返すも勝率が40%程度からあがる気配がなく中断。<br>

![switch2f9j_tpwe1](https://raw.githubusercontent.com/y-tetsu/reversi/images/switch2f9j_tpwe1.png)

```
世代数 : 1064
適応度 : 46.7%(vs既存パラメータの勝率)
corner : [  147,   58,   39,   74,    92]
c      : [ -114, -147,  -73,   25,  -112]
a1     : [ -174,  -31,   22,   -7,  -159]
a2     : [  -51, -167,  -79, -101,   -82]
b1     : [  118,  -86, -104,   41,     3]
b2     : [ -115,  -27,   10,  -35,   108]
b3     : [  -82,   45,    6,   92,   157]
x      : [ -104, -141, -121, -107,  -133]
o1     : [ -163, -135, -111, -115,  -119]
o2     : [   -1,  -16,  -15,  -20,   -65]
wp     : [  115,  110,   84,  199,   172]
ww     : [10003, 9999, 9974, 9999, 10003]
we     : [  190,  185,  178,  215,   170]
```

## switch2f9j_tpwe(2)
### 目的
Tableパラメータ(corner, c, a1, a2, b1, b2, b3, x, o1, o2)+着手可能数パラメータ(wp)+勝敗パラメータ(ww)+エッジパラメータ(we)をより強くするパラメータ値を求める。
かつ、ゲームの進行に合わせた5段階分のパラメータ値を求める。
定石打ちと終盤石差読み(残り9手)も適用する。

### 条件
既存のパラメータ値(5段階分すべて同値)の個体から開始し、既存パラメータの個体と2手読み同士で対戦させ勝率の高いものを次の世代に入れ替える。

```JSON
{
    "max_generations": 200,
    "population_num": 24,
    "offspring_num": 12,
    "mutation_chance": 0.3,
    "mutation_value": 3,
    "large_mutation": 50,
    "large_mutation_value": 10,
    "turns": [12, 24, 36, 48, 60],
    "board_size": 8,
    "matches": 300,
    "threshold": 80,
    "random_opening": 8,
    "processes": 2
}
```

### 結果
200世代ほどから勝率60%を超える個体が現れ、複数手読みの戦略にパラメータを適用した場合も既存より強かったため採用。<br>

![switch2f9j_tpwe2](https://raw.githubusercontent.com/y-tetsu/reversi/images/switch2f9j_tpwe2.png)

```
世代数 : 843
適応度 : 64.2%(vs既存パラメータの勝率)
corner : [  50,    44,   41,   62,   50]
c      : [ -20,   -18,  -14,  -19,  -23]
a1     : [ -10,    -4,   -1,    1,    0]
a2     : [   0,    -2,   -4,    0,   -9]
b1     : [  -4,    -2,   -4,   -1,   -2]
b2     : [  -2,    -4,   -1,    0,   -2]
b3     : [  -2,    -3,    2,    1,   16]
x      : [ -25,   -40,  -38,  -25,  -25]
o1     : [ -13,   -10,   -5,   -4,   -9]
o2     : [  -5,    -8,   -5,   -2,   -8]
wp     : [   4,     4,    4,    8,    8]
ww     : [9999, 10001, 9996, 9990, 9998]
we     : [  91,    95,  103,   94,   93]
```
